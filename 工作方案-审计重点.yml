app:
  description: ''
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: å·¥ä½œæ–¹æ¡ˆ-å®¡è®¡é‡ç‚¹
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/tongyi:0.1.1@5cd6896c375b6765252176760ddcae95bdd2466991ff2a8bae4e1cfd1da98e13
kind: app
version: 0.4.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: knowledge-retrieval
      id: 1763978629883-source-1763978674900-target
      source: '1763978629883'
      sourceHandle: source
      target: '1763978674900'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1763978674900-source-1763978715962-target
      source: '1763978674900'
      sourceHandle: source
      target: '1763978715962'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: code
      id: 1763978715962-source-1763978889021-target
      source: '1763978715962'
      sourceHandle: source
      target: '1763978889021'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: iteration
      id: 1763978889021--1763979170122-target
      source: '1763978889021'
      sourceHandle: source
      target: '1763979170122'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1763979170122'
        sourceType: iteration-start
        targetType: code
      id: 1763979170122start-source-1763979172962-target
      source: 1763979170122start
      sourceHandle: source
      target: '1763979172962'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: true
        isInLoop: false
        iteration_id: '1763979170122'
        sourceType: code
        targetType: llm
      id: 1763979172962-source-1763979359779-target
      source: '1763979172962'
      sourceHandle: source
      target: '1763979359779'
      targetHandle: target
      type: custom
      zIndex: 1002
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: iteration
        targetType: code
      id: 1763979170122-source-1763979605691-target
      source: '1763979170122'
      sourceHandle: source
      target: '1763979605691'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: code
        targetType: answer
      id: 1763979605691-source-1763979693740-target
      source: '1763979605691'
      sourceHandle: source
      target: '1763979693740'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ''
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: project_name
          max_length: 48
          options: []
          required: true
          type: text-input
          variable: project_name
        - label: description
          max_length: 255
          options: []
          required: false
          type: text-input
          variable: description
      height: 115
      id: '1763978629883'
      position:
        x: 86
        y: 282
      positionAbsolute:
        x: 86
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        dataset_ids:
        - hjHEvA3bDGN3HLMdKICFZwVZ48UkebPsY42CTHPU5nNn1iU42RFt8mMcfFH/eDfF
        desc: ''
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: reranking_model
          reranking_model:
            model: gte-rerank
            provider: langgenius/tongyi/tongyi
          top_k: 4
        query_variable_selector:
        - '1763978629883'
        - sys.query
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢-3å®¡è®¡é‡ç‚¹
        type: knowledge-retrieval
      height: 91
      id: '1763978674900'
      position:
        x: 377.71835835137733
        y: 287.58256438573756
      positionAbsolute:
        x: 377.71835835137733
        y: 287.58256438573756
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        context:
          enabled: true
          variable_selector:
          - '1763978674900'
          - result
        desc: ''
        model:
          completion_params:
            enable_thinking: false
            temperature: 0.7
          mode: chat
          name: qwen3-32b
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 980c9f6a-d54f-4bef-b145-86c1f29dacd1
          role: system
          text: "* **è§’è‰²è®¾å®š**\n  ä½ æ˜¯æ¹–åŒ—çœå®¡è®¡å…è‡ªç„¶èµ„æºå¤„çš„ä¸šåŠ¡ä¸“å®¶ï¼Œè´Ÿè´£èµ·è‰å¸‚å¿å…šæ”¿ä¸»è¦é¢†å¯¼å¹²éƒ¨è‡ªç„¶èµ„æºèµ„äº§ç¦»ä»»å®¡è®¡å·¥ä½œæ–¹æ¡ˆã€‚\n\
            \  éœ€è¦éµå¾ªæ¹–åŒ—çœå®¡è®¡å…å…¬æ–‡å†™ä½œè§„èŒƒï¼Œä½“ç°ä¸­å¤®æ–‡ä»¶ç²¾ç¥å’Œæ¹–åŒ—åœ°æ–¹ç‰¹è‰²ã€‚\n\n* **æ–‡æ¡£æ•´ä½“ç»“æ„**\n  æ–‡æ¡£å›ºå®šåŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š\n\n\
            \  ä¸€. æ ‡é¢˜å’Œæ”¿ç­–ä¾æ®\n  äºŒ. å®¡è®¡ç›®æ ‡\n  ä¸‰. å®¡è®¡å¯¹è±¡èŒƒå›´å’Œæ—¶é™\n  å››. å®¡è®¡å†…å®¹å’Œé‡ç‚¹ï¼ˆå…­å¤§æ–¹é¢ï¼‰\n  äº”. å®¡è®¡ç»„ç»‡æ–¹å¼å’Œæ—¶é—´å®‰æ’\n\
            \  å…­. å·¥ä½œè¦æ±‚\n  ä¸ƒ. é™„ä»¶æ¸…å•\n\n* **æ ¼å¼è¦æ±‚**\n\n  * ä¸€çº§æ ‡é¢˜ï¼šä¸­æ–‡æ•°å­—ï¼ˆå¦‚â€œä¸€ã€äºŒã€ä¸‰â€ï¼‰\n  * äºŒçº§æ ‡é¢˜ï¼šä¸­æ–‡æ•°å­—åŠ æ‹¬å·ï¼ˆå¦‚â€œï¼ˆä¸€ï¼‰ï¼ˆäºŒï¼‰â€ï¼‰\n\
            \  * ä¸‰çº§æ ‡é¢˜ï¼šé˜¿æ‹‰ä¼¯æ•°å­—ï¼ˆå¦‚â€œ1. 2.â€ï¼‰\n  * æ®µè½ç”¨ä¸­æ–‡æ ‡ç‚¹ï¼Œä¿æŒæ­£å¼å…¬æ–‡é£æ ¼\n\né¡¹ç›®æè¿°ï¼š\n{{#sys.query#}}\n\
            \nå®¡è®¡é‡ç‚¹ï¼š\n{{#context#}}\n\nä½ æ˜¯ä¸€åç†Ÿæ‚‰è‡ªç„¶èµ„æºèµ„äº§ç¦»ä»»å®¡è®¡çš„å…¬æ–‡èµ·è‰ä¸“å®¶ã€‚\nå·²çŸ¥æœ¬ç« æ ‡é¢˜ä¸ºâ€œä¸‰ã€å®¡è®¡å†…å®¹å’Œé‡ç‚¹â€ï¼Œç›®æ ‡æ˜¯å¯¹å®¡è®¡å†…å®¹å’Œé‡ç‚¹è¿›è¡Œç³»ç»Ÿé˜è¿°ã€‚\n\
            \nç°è¯·ä½ æ ¹æ®å‚è€ƒæ–‡æœ¬ç›´æ¥ç”Ÿæˆæ‰å¹³çš„å†™ä½œä»»åŠ¡åˆ—è¡¨ï¼Œæ¯ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªâ€œä¸€çº§å°æ ‡é¢˜ + äºŒçº§å°æ ‡é¢˜â€çš„ç»„åˆã€‚\n\nè¦æ±‚ï¼š\n\nä¸€çº§å°æ ‡é¢˜é‡‡ç”¨â€œï¼ˆä¸€ï¼‰ï¼ˆäºŒï¼‰ï¼ˆä¸‰ï¼‰â€¦â€¦â€çš„ç»“æ„ï¼ŒäºŒçº§å°æ ‡é¢˜é‡‡ç”¨â€œ1.\
            \ 2. 3. â€¦â€¦â€çš„ç»“æ„ï¼›\nä¸è¦åµŒå¥—ç»“æ„ï¼Œæ‰€æœ‰ä»»åŠ¡ä»¥æ‰å¹³æ•°ç»„å½¢å¼ç»™å‡ºï¼›\næ¯ä¸ªä»»åŠ¡éœ€åŒ…å«ï¼šæ‰€å±ä¸€çº§æ ‡é¢˜ä¿¡æ¯ã€äºŒçº§æ ‡é¢˜ä¿¡æ¯ã€å»ºè®®å­—æ•°ã€å…³é”®å†™ä½œè¦ç‚¹åˆ—è¡¨ã€‚\n\
            å½“ç”¨æˆ·ç»™å‡ºå‚è€ƒæ¡ˆä¾‹æ—¶ï¼Œç¦æ­¢ç…§æŠ„æ•´ç†ï¼Œè€Œæ˜¯éœ€è¦æ ¹æ®å‚è€ƒæ¡ˆä¾‹çš„æ€è·¯ï¼Œç»“åˆå®¡è®¡é¡¹ç›®å®é™…æƒ…å†µè¿›è¡Œåˆ†æã€æ¶¦è‰²ã€ä¼˜åŒ–ã€‚\n\n\nè¾“å‡ºä¸¥æ ¼ä½¿ç”¨å¦‚ä¸‹ JSON\
            \ ç»“æ„ï¼š\n{\n  â€œchapter_noâ€: â€œä¸‰â€,\n  â€œchapter_titleâ€: â€œå®¡è®¡å†…å®¹å’Œé‡ç‚¹â€,\n  â€œitemsâ€:\
            \ [\n    {\n      â€œorderâ€: 1,\n      â€œfirst_idâ€: â€œä¸€â€,\n      â€œfirst_markerâ€:\
            \ â€œï¼ˆä¸€ï¼‰â€,\n      â€œfirst_titleâ€: â€œâ€¦â€,\n      â€œsecond_idâ€: â€œ1â€,\n      â€œsecond_markerâ€:\
            \ â€œ1.â€,\n      â€œsecond_titleâ€: â€œâ€¦â€,\n      â€œtarget_lengthâ€: â€œ400-600å­—â€,\n\
            \      â€œkey_pointsâ€: [â€â€¦â€, â€œâ€¦â€]\n    }\n  // â€¦\n  ]\n}\n\nåªè¾“å‡º JSONï¼Œä¸è¦å¤šä½™è¯´æ˜ã€‚"
        - id: 5d17ed6d-8377-40ce-8823-c1cfbd3a16ca
          role: user
          text: 'è¯·å‚è€ƒè¿™ä¸ªå¾€å¹´çš„æ¡ˆä¾‹ï¼ŒæŒ‰ç…§æç¤ºè¯æ¨¡æ¿è¦æ±‚ï¼Œç”Ÿæˆç¬¬ä¸‰ç« ç›®å½•ç»“æ„ï¼Œä»¥jsonå½¢å¼è¾“å‡ºã€‚

            è¯·ç»“åˆå½“å¹´æƒ…å†µè¿›è¡Œé€‚å½“çš„æ¶¦è‰²ã€ç»„ç»‡å’Œä¼˜åŒ–ï¼Œä¸€å®šè¦æœ‰å˜åŒ–ã€‚


            æ¡ˆä¾‹å‚è€ƒï¼š

            ä¸‰ã€å®¡è®¡å†…å®¹å’Œé‡ç‚¹

            ï¼ˆä¸€ï¼‰è‡ªç„¶èµ„æºèµ„äº§å®ç‰©é‡å˜åŒ–å’Œç‰¹å®šè´Ÿé¢äº‹é¡¹

            1.è‡ªç„¶èµ„æºèµ„äº§å®ç‰©é‡å˜åŒ–æ–¹é¢ã€‚

            2.ç‰¹å®šè´Ÿé¢äº‹é¡¹æ–¹é¢ã€‚

            ï¼ˆäºŒï¼‰è´¯å½»æ‰§è¡Œç”Ÿæ€æ–‡æ˜å»ºè®¾æ–¹é’ˆæ”¿ç­–å’Œå†³ç­–éƒ¨ç½²æƒ…å†µ

            1.ç”Ÿæ€æ–‡æ˜å»ºè®¾é‡å¤§å†³ç­–éƒ¨ç½²è½å®æ–¹é¢ã€‚

            2.è´¯å½»è½å®ç”Ÿæ€æ–‡æ˜å»ºè®¾ç›¸å…³é‡è¦æŒ‡ç¤ºæ‰¹ç¤ºæ–¹é¢ã€‚

            3.ç”Ÿæ€æ–‡æ˜ä½“åˆ¶æ”¹é©é‡ç‚¹ä»»åŠ¡æ¨è¿›æ–¹é¢ã€‚

            ï¼ˆä¸‰ï¼‰éµå®ˆè‡ªç„¶èµ„æºèµ„äº§ç®¡ç†å’Œç”Ÿæ€ç¯å¢ƒä¿æŠ¤æ³•å¾‹æ³•è§„ä»¥åŠå‚ä¸æœ‰å…³å†³ç­–æƒ…å†µ

            1.è‡ªç„¶èµ„æºèµ„äº§ç®¡ç†å’Œç”Ÿæ€ç¯å¢ƒä¿æŠ¤ç›¸å…³æ³•å¾‹æ³•è§„ã€æ”¿ç­–æªæ–½å’Œé‡å¤§è§„åˆ’çš„åˆ¶å®šã€å®æ–½ã€è°ƒæ•´æ–¹é¢ã€‚

            2.é‡å¤§äº‹é¡¹å†³ç­–ã€å®¡æ‰¹æ–¹é¢ã€‚

            3.é‡å¤§ç»æµæ´»åŠ¨æˆ–å»ºè®¾é¡¹ç›®éµå®ˆæ³•å¾‹æ³•è§„æ–¹é¢ã€‚

            ï¼ˆå››ï¼‰è‡ªç„¶èµ„æºå¼€å‘åˆ©ç”¨ä¸ç”Ÿæ€ä¿æŠ¤ä¿®å¤æƒ…å†µ

            1.åœŸåœ°èµ„æºå¼€å‘åˆ©ç”¨åŠè€•åœ°ä¿æŠ¤æ–¹é¢ã€‚

            2.æ°´èµ„æºå¼€å‘åˆ©ç”¨åŠç”Ÿæ€ä¿æŠ¤ä¿®å¤æ–¹é¢ã€‚

            3.çŸ¿äº§èµ„æºå¼€å‘åˆ©ç”¨åŠçŸ¿å±±ç¯å¢ƒç»¼åˆæ²»ç†æ–¹é¢ã€‚

            4.æ£®æ—ã€æ¹¿åœ°å¼€å‘åˆ©ç”¨åŠç”Ÿæ€ä¿æŠ¤ä¿®å¤æ–¹é¢ã€‚

            5.åŒºåŸŸç‰¹è‰²èµ„æºå¼€å‘åˆ©ç”¨åŠç”Ÿæ€ä¿æŠ¤ä¿®å¤æ–¹é¢ã€‚

            ï¼ˆäº”ï¼‰èµ„æºç¯å¢ƒçº¦æŸæ€§æŒ‡æ ‡å®ŒæˆåŠæœ‰å…³ç›‘ç£è€ƒè¯„æƒ…å†µ

            1.èµ„æºç¯å¢ƒçº¦æŸæ€§æŒ‡æ ‡å®Œæˆæ–¹é¢ã€‚

            2.èµ„æºç¯å¢ƒç›‘ç£è€ƒè¯„æ–¹é¢ã€‚

            3.ä»¥å‰å¹´åº¦æŸ¥å‡ºé—®é¢˜æ•´æ”¹è½å®æ–¹é¢ã€‚

            4.èµ„æºç¯å¢ƒç»Ÿè®¡æ•°æ®æˆ–ç›‘æµ‹æ•°æ®çœŸå®æ€§ç›‘ç®¡æ–¹é¢ã€‚

            5.å…¬ä¼—å¯¹æœ¬åœ°åŒºè‡ªç„¶èµ„æºèµ„äº§ç®¡ç†å’Œç”Ÿæ€ç¯å¢ƒä¿æŠ¤æƒ…å†µçš„æ»¡æ„åº¦ã€‚

            ï¼ˆå…­ï¼‰èµ„æºç¯å¢ƒç›¸å…³èµ„é‡‘é¡¹ç›®ç®¡ç†ç»©æ•ˆ

            1.èµ„æºç¯å¢ƒé¢†åŸŸè´¢æ”¿èµ„é‡‘ä½¿ç”¨ç»©æ•ˆæ–¹é¢ã€‚

            2.èµ„æºç¯å¢ƒé¢†åŸŸé¡¹ç›®å»ºè®¾ç›®æ ‡å®Œæˆæ–¹é¢ã€‚'
        selected: false
        structured_output:
          schema:
            additionalProperties: false
            properties:
              chapter_no:
                type: string
              chapter_title:
                type: string
              items:
                items:
                  additionalProperties: false
                  properties:
                    first_id:
                      type: string
                    first_marker:
                      type: string
                    first_title:
                      type: string
                    key_points:
                      items:
                        type: string
                      type: array
                    order:
                      type: number
                    second_id:
                      type: string
                    second_marker:
                      type: string
                    second_title:
                      type: string
                    target_length:
                      type: string
                  required:
                  - order
                  - first_id
                  - first_marker
                  - first_title
                  - second_id
                  - second_marker
                  - second_title
                  - target_length
                  - key_points
                  type: object
                type: array
            required:
            - chapter_no
            - chapter_title
            - items
            type: object
        structured_output_enabled: true
        title: ä¸‰å®¡è®¡é‡ç‚¹çš„ï¼ˆäºŒï¼‰çº§æ ‡é¢˜
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1763978715962'
      position:
        x: 694.9184883580733
        y: 282
      positionAbsolute:
        x: 694.9184883580733
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        code: "def main(arg1) -> dict:\n    return {\n        \"result\": arg1,\n\
          \    }"
        code_language: python3
        desc: ''
        outputs:
          result:
            children: null
            type: array[object]
        selected: false
        title: ä»£ç æ‰§è¡Œ
        type: code
        variables:
        - value_selector:
          - '1763978715962'
          - structured_output
          - items
          value_type: object
          variable: arg1
      height: 53
      id: '1763978889021'
      position:
        x: 998
        y: 282
      positionAbsolute:
        x: 998
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        desc: ''
        error_handle_mode: terminated
        height: 169
        is_parallel: true
        iterator_input_type: array[object]
        iterator_selector:
        - '1763978889021'
        - result
        output_selector:
        - '1763979359779'
        - text
        output_type: array[string]
        parallel_nums: 10
        selected: false
        start_node_id: 1763979170122start
        title: è¿­ä»£
        type: iteration
        width: 692
      height: 169
      id: '1763979170122'
      position:
        x: 1270.1357939656398
        y: 309.7183583513774
      positionAbsolute:
        x: 1270.1357939656398
        y: 309.7183583513774
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 692
      zIndex: 1
    - data:
        desc: ''
        isInIteration: true
        selected: false
        title: ''
        type: iteration-start
      draggable: false
      height: 48
      id: 1763979170122start
      parentId: '1763979170122'
      position:
        x: 24
        y: 68
      positionAbsolute:
        x: 1294.1357939656398
        y: 377.7183583513774
      selectable: false
      sourcePosition: right
      targetPosition: left
      type: custom-iteration-start
      width: 44
      zIndex: 1002
    - data:
        code: "def main(arg1) -> dict:\n    return {\n        \"order\": arg1.get(\"\
          order\", 0),\n        \"first_id\": arg1.get(\"first_id\", \"\"),\n    \
          \    \"first_marker\": arg1.get(\"first_marker\", \"\"),\n        \"first_title\"\
          : arg1.get(\"first_title\", \"\"),\n        \"second_id\": arg1.get(\"second_id\"\
          , \"\"),\n        \"second_marker\": arg1.get(\"second_marker\", \"\"),\n\
          \        \"second_title\": arg1.get(\"second_title\", \"\"),\n        \"\
          target_length\": arg1.get(\"target_length\", \"\"),\n        \"key_points\"\
          : arg1.get(\"key_points\", []),\n    }"
        code_language: python3
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1763979170122'
        outputs:
          first_id:
            children: null
            type: string
          first_marker:
            children: null
            type: string
          first_title:
            children: null
            type: string
          key_points:
            children: null
            type: array[string]
          order:
            children: null
            type: number
          second_id:
            children: null
            type: string
          second_marker:
            children: null
            type: string
          second_title:
            children: null
            type: string
          target_length:
            children: null
            type: string
        selected: false
        title: ä»£ç æ‰§è¡Œ 2
        type: code
        variables:
        - value_selector:
          - '1763979170122'
          - item
          value_type: object
          variable: arg1
      height: 53
      id: '1763979172962'
      parentId: '1763979170122'
      position:
        x: 128
        y: 68
      positionAbsolute:
        x: 1398.1357939656398
        y: 377.7183583513774
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
      zIndex: 1002
    - data:
        context:
          enabled: true
          variable_selector:
          - '1763978674900'
          - result
        desc: ''
        isInIteration: true
        isInLoop: false
        iteration_id: '1763979170122'
        model:
          completion_params:
            enable_thinking: false
            temperature: 0.7
          mode: chat
          name: qwen3-32b
          provider: langgenius/tongyi/tongyi
        prompt_template:
        - id: 36b26051-0da3-4365-b21e-f27f93732fe9
          role: system
          text: "* **è§’è‰²è®¾å®š**\n  ä½ æ˜¯æ¹–åŒ—çœå®¡è®¡å…è‡ªç„¶èµ„æºå¤„çš„ä¸šåŠ¡ä¸“å®¶ï¼Œè´Ÿè´£èµ·è‰å¸‚å¿å…šæ”¿ä¸»è¦é¢†å¯¼å¹²éƒ¨è‡ªç„¶èµ„æºèµ„äº§ç¦»ä»»å®¡è®¡å·¥ä½œæ–¹æ¡ˆã€‚\n\
            \  éœ€è¦éµå¾ªæ¹–åŒ—çœå®¡è®¡å…å…¬æ–‡å†™ä½œè§„èŒƒï¼Œä½“ç°ä¸­å¤®æ–‡ä»¶ç²¾ç¥å’Œæ¹–åŒ—åœ°æ–¹ç‰¹è‰²ã€‚\n\n* **æ–‡æ¡£æ•´ä½“ç»“æ„**\n  æ–‡æ¡£å›ºå®šåŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š\n\n\
            \  ä¸€. æ ‡é¢˜å’Œæ”¿ç­–ä¾æ®\n  äºŒ. å®¡è®¡ç›®æ ‡\n  ä¸‰. å®¡è®¡å¯¹è±¡èŒƒå›´å’Œæ—¶é™\n  å››. å®¡è®¡å†…å®¹å’Œé‡ç‚¹ï¼ˆå…­å¤§æ–¹é¢ï¼‰\n  äº”. å®¡è®¡ç»„ç»‡æ–¹å¼å’Œæ—¶é—´å®‰æ’\n\
            \  å…­. å·¥ä½œè¦æ±‚\n  ä¸ƒ. é™„ä»¶æ¸…å•\n\n* **æ ¼å¼è¦æ±‚**\n\n  * ä¸€çº§æ ‡é¢˜ï¼šä¸­æ–‡æ•°å­—ï¼ˆå¦‚â€œä¸€ã€äºŒã€ä¸‰â€ï¼‰\n  * äºŒçº§æ ‡é¢˜ï¼šä¸­æ–‡æ•°å­—åŠ æ‹¬å·ï¼ˆå¦‚â€œï¼ˆä¸€ï¼‰ï¼ˆäºŒï¼‰â€ï¼‰\n\
            \  * ä¸‰çº§æ ‡é¢˜ï¼šé˜¿æ‹‰ä¼¯æ•°å­—ï¼ˆå¦‚â€œ1. 2.â€ï¼‰\n  * æ®µè½ç”¨ä¸­æ–‡æ ‡ç‚¹ï¼Œä¿æŒæ­£å¼å…¬æ–‡é£æ ¼\n\nå®¡è®¡é‡ç‚¹ï¼š\n{{#context#}}\n\
            \nä½ æ­£åœ¨ä¸ºä¸€ä»½è‡ªç„¶èµ„æºèµ„äº§ç¦»ä»»å®¡è®¡æ–‡ä¹¦ç¼–å†™æœ¬ç« \"ä¸‰ã€å®¡è®¡å†…å®¹å’Œé‡ç‚¹\"ä¸­çš„ä¸€ä¸ªäºŒçº§å°èŠ‚å†…å®¹ã€‚\n\nã€æ‰€å±ä¸€çº§å°æ ‡é¢˜ã€‘\n\næ ‡è¯†ï¼š{{#1763979172962.first_id#}}\n\
            æ ‡é¢˜ï¼š{{#1763979172962.first_title#}}\n\nã€å½“å‰äºŒçº§å°æ ‡é¢˜å†™ä½œä»»åŠ¡ã€‘\n\nç¼–å·ï¼š{{#1763979172962.second_id#}}\n\
            æ ‡é¢˜ï¼š{{#1763979172962.second_title#}}\nå»ºè®®é•¿åº¦ï¼š{{#1763979172962.target_length#}}\n\
            å…³é”®è¦ç‚¹ï¼š{{#1763979172962.key_points#}}\n\nè¯·æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œå‚è€ƒä¸‹åˆ—ç¤ºä¾‹æ–‡é£ï¼Œç”Ÿæˆè¯¥äºŒçº§å°æ ‡é¢˜ä¸‹çš„å…·ä½“å†…å®¹ï¼š\n\
            \né¦–å…ˆè¾“å‡ºä¸€è¡Œï¼š\"{{#1763979172962.second_marker#}} {{#1763979172962.second_title#}}ã€‚\"\
            \nç„¶åæŒ‰\"ï¼ˆ1ï¼‰ï¼ˆ2ï¼‰ï¼ˆ3ï¼‰â€¦â€¦\"åˆ—å‡º 2ï½4 ä¸ªå°ç‚¹ï¼Œæ¯ä¸ªå°ç‚¹ 2ï½4 å¥ï¼Œå†…å®¹å›´ç»•å…³é”®è¦ç‚¹å±•å¼€ï¼Œå†™æ˜è¦è°ƒé˜…çš„èµ„æ–™ã€åˆ†æç»´åº¦ã€é‡ç‚¹æ­ç¤ºçš„é—®é¢˜ã€‚\n\
            æ–‡é£å‚ç…§å…šæ”¿å…¬æ–‡å’Œä½ æä¾›çš„æ ·ä¾‹ï¼Œå¦‚\"ï¼ˆ1ï¼‰æ‘¸æ¸…æ°´èµ„æºå®ç‰©é‡åº•æ•°åŠå¤§å¹…å‡å°‘æƒ…å†µã€‚è°ƒé˜…æ°´åˆ©éƒ¨é—¨æ°´èµ„æºå…¬æŠ¥â€¦â€¦\"ã€‚\nä¸¥æ ¼é™å®šåœ¨æœ¬äºŒçº§æ ‡é¢˜åŠå…¶æ‰€å±ä¸€çº§æ ‡é¢˜èŒƒå›´å†…ï¼Œä¸å¾—æ‰©å±•åˆ°å…¶ä»–ç« èŠ‚å†…å®¹ã€‚\n\
            \nè¾“å‡ºæ ¼å¼\n\nçº¯æ–‡æœ¬ç‰‡æ®µï¼›\nä¸è¦è¾“å‡ºæ‰€å±ä¸€çº§æ ‡é¢˜ï¼ˆå¦‚\"ï¼ˆä¸€ï¼‰â€¦â€¦\"ï¼‰ï¼Œåªå†™å½“å‰äºŒçº§æ ‡é¢˜åŠå…¶å…·ä½“å†…å®¹ã€‚\n\né‡è¦æ ¼å¼è¦æ±‚ï¼š\n\
            è¯·ç›´æ¥è¾“å‡º JSON å­—ç¬¦ä¸²ï¼Œä¸è¦åŒ…å« ```json ç­‰ Markdown æ ‡è®°ã€‚\nJSON å†…å®¹ä¸­çš„åŒå¼•å·å¿…é¡»è½¬ä¹‰ï¼ˆä¾‹å¦‚ä½¿ç”¨ \\\"\
            ï¼‰ï¼Œæˆ–è€…ç¡®ä¿å†…å®¹ä¸­åªä½¿ç”¨ä¸­æ–‡å¼•å·ï¼ˆâ€œâ€ï¼‰ã€‚\nå¦‚æœå†…å®¹åŒ…å«æ¢è¡Œç¬¦ï¼Œè¯·ä½¿ç”¨ \\nã€‚\n\næœ€ç»ˆè¯·ç”¨å¦‚ä¸‹ JSON ç»“æ„è¿”å›ï¼š\n{\n\"\
            order\": {{#1763979172962.order#}}\n\"first_id\": \"{{#1763979172962.first_id#}}\"\
            ,\n\"first_marker\": \"{{#1763979172962.first_marker#}}\",\n\"first_title\"\
            : \"{{#1763979172962.first_title#}}\",\n\"second_id\": \"{{#1763979172962.second_id#}}\"\
            ,\n\"second_marker\": \"{{#1763979172962.second_marker#}}\",\n\"second_title\"\
            : \"{{#1763979172962.second_title#}}\",\n\"content\": \"è¿™é‡Œæ˜¯å®é™…ç”Ÿæˆçš„æ–‡æœ¬\"\n\
            }"
        - id: ef04e5c5-f52b-43dc-a5ca-7b4d996d4e6d
          role: user
          text: 'æŒ‰ç…§è¦æ±‚ç”Ÿæˆjsonæ ¼å¼çš„å®¡è®¡é‡ç‚¹å°ç»“å†…å®¹ã€‚contentçš„è¯­è¨€ç”¨ä¸”ä»…ç”¨â€œå…³æ³¨xxxxxx"ã€â€é‡ç‚¹æ ¸æŸ¥xxxxxâ€œè¿™ç§æ ¼å¼ã€‚æ ¹æ®éœ€è¦ï¼Œå¦‚æœä¸€ä¸ªå°èŠ‚å†…å®¹éœ€è¦å±•å¼€å¤šä¸ªæ–¹é¢ï¼Œå¯ä»¥ç”¨â€ä¸€æ˜¯â€œã€â€äºŒæ˜¯â€œç­‰ç­‰å¹¶åˆ—æ ¼å¼å±•å¼€ï¼Œå¦‚æœä¸å¿…å±•å¼€å°±åªç”¨å…³æ³¨å’Œé‡ç‚¹æ ¸æŸ¥å¥å¼ã€‚


            ç¤ºä¾‹ï¼ˆä¸å¯ç…§æŠ„ï¼Œä»…ä¾›å‚è€ƒæ–‡ç« ç»“æ„ï¼‰ï¼š

            3.é‡å¤§ç»æµæ´»åŠ¨æˆ–å»ºè®¾é¡¹ç›®éµå®ˆæ³•å¾‹æ³•è§„æ–¹é¢ã€‚

            ä¸€æ˜¯å…³æ³¨è‡ªç„¶èµ„æºèµ„äº§ç®¡ç†å’Œç”Ÿæ€ç¯å¢ƒä¿æŠ¤ç›¸å…³æ³•å¾‹æ³•è§„æ‰§è¡Œæƒ…å†µã€‚é‡ç‚¹æ ¸æŸ¥æ˜¯å¦å­˜åœ¨è¿åè‡ªç„¶èµ„æºç®¡ç†å’Œç”Ÿæ€ç¯å¢ƒä¿æŠ¤æ³•å¾‹æ³•è§„ä¸”é€ æˆä¸¥é‡åæœæˆ–ä¸è‰¯å½±å“ï¼Œç”±ä¸Šçº§å…šå§”å’Œæ”¿åºœï¼ˆå«æˆæƒæœ‰å…³éƒ¨é—¨ï¼‰çº¦è°ˆé€šæŠ¥æˆ–ç”±ä¸­å¤®åŠçœé¢†å¯¼åŒå¿—æŒ‡ç¤ºæ‰¹ç¤ºä¸¥è‚ƒæŸ¥å¤„æˆ–æ‰¹è¯„é—®è´£çš„æƒ…å½¢ï¼›æ˜¯å¦å­˜åœ¨é•¿æ±ŸæµåŸŸç”Ÿæ€ç¯å¢ƒä¿æŠ¤å’Œä¿®å¤ã€åœŸåœ°åˆ©ç”¨ç®¡ç†å’Œè€•åœ°ä¿æŠ¤ã€çŸ¿äº§èµ„æºå¼€å‘åˆ©ç”¨ç­‰æŸä¸€é¢†åŸŸè¿æ³•è¿è§„é—®é¢˜æ•°é‡è¾ƒå¤šã€æ¶‰åŠé¢è¾ƒå¹¿ï¼Œæˆ–ç”±ä¸Šçº§éƒ¨é—¨ç«‹æ¡ˆæŸ¥å¤„ã€æŒ‚ç‰Œç£åŠã€è­¦ç¤ºçº¦è°ˆä¸”å°šæœªæ¶ˆé™¤è¿æ³•çŠ¶æ€çš„é—®é¢˜ã€‚

            äºŒæ˜¯å…³æ³¨æ±¡æŸ“é˜²æ²»æ”»åšæƒ…å†µã€‚é‡ç‚¹æ ¸æŸ¥æ˜¯å¦å­˜åœ¨é‡å¤§é¡¹ç›®æœªç»ç¯è¯„ã€æ°´åœŸä¿æŒç­‰å®¡æ‰¹æ“…è‡ªå¼€å·¥å»ºè®¾ï¼Œæœªç»ç¯å¢ƒä¿æŠ¤éªŒæ”¶æŠ•äº§è¿è¥ï¼ŒæœªæŒ‰ç¯è¯„è¦æ±‚å»ºè®¾å®‰è£…ç¯ä¿è®¾æ–½ï¼Œé€ æˆç¯å¢ƒæ±¡æŸ“ï¼Œç›¸å…³ä¸»ç®¡éƒ¨é—¨æŸ¥å¤„æˆ–ç£ä¿ƒæ•´æ”¹ä¸åŠ›ç­‰é—®é¢˜ã€‚'
        selected: false
        structured_output:
          schema:
            additionalProperties: false
            properties:
              content:
                type: string
              first_id:
                type: string
              first_marker:
                type: string
              first_title:
                type: string
              order:
                type: number
              second_id:
                type: string
              second_marker:
                type: string
              second_title:
                type: string
            required:
            - order
            - first_id
            - second_id
            - second_marker
            - second_title
            - content
            - first_title
            - first_marker
            type: object
        structured_output_enabled: true
        title: ä¸‰å®¡è®¡é‡ç‚¹çš„3çº§æ ‡é¢˜åŠå†…å®¹
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1763979359779'
      parentId: '1763979170122'
      position:
        x: 432
        y: 60
      positionAbsolute:
        x: 1702.1357939656398
        y: 369.7183583513774
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
      zIndex: 1002
    - data:
        code: "from collections import defaultdict\nimport json\n\ndef main(arg1)\
          \ -> dict:\n    \"\"\"\n    æŠŠè¾“å…¥çš„åˆ—è¡¨/JSON åˆå¹¶æˆåˆ†ç»„ Markdownã€‚\n    - æ”¯æŒå­—ç¬¦ä¸² JSON\
          \ / dict åŒ… list / ç›´æ¥ list\n    - æŒ‰ first_id åˆ†ç»„ã€ä¸­æ–‡æ•°å­—é¡ºåºæ’åº\n    - ç»„å†…æŒ‰ second_id/second_marker/order\
          \ æ’åºï¼Œå…œåº•åŸå§‹é¡ºåº\n    - é¿å…é‡å¤è¾“å‡ºäºŒçº§æ ‡é¢˜ï¼ˆè‹¥ content å·²ä»¥åŒæ ·æ ‡é¢˜å¼€å¤´åˆ™è·³è¿‡ï¼‰\n    \"\"\"\n\n   \
          \ def parse_maybe_int(val):\n        \"\"\"æŠŠç±»ä¼¼ '3.' æˆ– '03' ç­‰å­—ç¬¦ä¸²å®‰å…¨è½¬æˆ intï¼Œå¤±è´¥è¿”å›\
          \ Noneã€‚\"\"\"\n        if val is None:\n            return None\n      \
          \  try:\n            return int(str(val).rstrip(\"ã€‚\").rstrip(\".\"))\n\
          \        except Exception:\n            return None\n\n    def ensure_trailing_punct(text:\
          \ str) -> str:\n        if not text:\n            return \"\"\n        if\
          \ text[-1] not in \"ã€‚.!?ï¼ï¼Ÿ\":\n            return text + \"ã€‚\"\n       \
          \ return text\n\n    def normalize_items(raw):\n        \"\"\"ç»Ÿä¸€è½¬æˆ list[dict]ï¼Œæ— æ³•è§£æè¿”å›ç©ºåˆ—è¡¨ã€‚\"\
          \"\"\n        items = raw\n        if isinstance(items, str):\n        \
          \    try:\n                items = json.loads(items)\n            except\
          \ Exception:\n                return []\n        if isinstance(items, dict):\n\
          \            if isinstance(items.get(\"items\"), list):\n              \
          \  items = items[\"items\"]\n            elif isinstance(items.get(\"result\"\
          ), list):\n                items = items[\"result\"]\n            else:\n\
          \                items = [items]\n        if not isinstance(items, list):\n\
          \            return []\n\n        normalized = []\n        for idx, it in\
          \ enumerate(items):\n            if isinstance(it, str):\n             \
          \   try:\n                    it = json.loads(it)\n                except\
          \ Exception:\n                    continue\n            if not isinstance(it,\
          \ dict):\n                continue\n            it = it.copy()\n       \
          \     it[\"first_id\"] = str(it.get(\"first_id\", \"\"))\n            it[\"\
          _index\"] = idx  # ä¿ç•™åŸå§‹é¡ºåº\n            normalized.append(it)\n        return\
          \ normalized\n\n    items = normalize_items(arg1)\n    if not items:\n \
          \       return {\"merged_markdown\": \"\"}\n\n    # åˆ†ç»„\n    grouped = defaultdict(list)\n\
          \    first_seen_index = {}\n    for item in items:\n        fid = item[\"\
          first_id\"]\n        grouped[fid].append(item)\n        first_seen_index.setdefault(fid,\
          \ item[\"_index\"])\n\n    # ç»„å†…æ’åºï¼šä¼˜å…ˆ second_id -> second_marker -> orderï¼Œå…œåº•åŸå§‹é¡ºåº\n\
          \    def item_sort_key(item):\n        num = parse_maybe_int(item.get(\"\
          second_id\"))\n        if num is None:\n            num = parse_maybe_int(item.get(\"\
          second_marker\"))\n        if num is None:\n            num = parse_maybe_int(item.get(\"\
          order\"))\n        if num is None:\n            return (1, item[\"_index\"\
          ])\n        return (0, num)\n\n    for fid in grouped:\n        grouped[fid]\
          \ = sorted(grouped[fid], key=item_sort_key)\n\n    # ä¸€çº§æ’åºï¼šä¸­æ–‡æ•°å­—é¡ºåºï¼ŒæœªçŸ¥çš„æŒ‰å‡ºç°é¡ºåºå…œåº•\n\
          \    cn_order = [\"ä¸€\", \"äºŒ\", \"ä¸‰\", \"å››\", \"äº”\", \"å…­\", \"ä¸ƒ\", \"å…«\"\
          , \"ä¹\", \"å\"]\n    order_map = {k: i for i, k in enumerate(cn_order)}\n\
          \    sorted_fids = sorted(\n        grouped.keys(),\n        key=lambda\
          \ fid: (order_map.get(fid, 999), first_seen_index.get(fid, 10 ** 9)),\n\
          \    )\n\n\n    # æ‹¼è£… Markdown\n    lines = [\"ä¸‰ã€å®¡è®¡å†…å®¹å’Œé‡ç‚¹\"]\n    for fid\
          \ in sorted_fids:\n        section_items = grouped[fid]\n        first_title\
          \ = section_items[0].get(\"first_title\", \"\")\n        lines.append(f\"\
          ï¼ˆ{fid}ï¼‰{first_title}\\n\" if first_title else f\"ï¼ˆ{fid}ï¼‰\\n\")\n\n     \
          \   for item in section_items:\n            marker = str(item.get(\"second_marker\"\
          , \"\") or \"\")\n            title = str(item.get(\"second_title\", \"\"\
          ) or \"\")\n            content = str(item.get(\"content\", \"\") or \"\"\
          )\n\n            heading = \" \".join([marker.strip(), title.strip()]).strip()\n\
          \            heading = ensure_trailing_punct(heading) if heading else \"\
          \"\n\n            # è‹¥å†…å®¹é¦–è¡Œå·²ç»ä»¥åŒæ ·æ ‡é¢˜å¼€å¤´ï¼Œåˆ™ä¸å†é‡å¤è¾“å‡ºæ ‡é¢˜\n            content_first_line\
          \ = content.lstrip().splitlines()[0].strip() if content else \"\"\n    \
          \        compare_heading = heading.rstrip(\"ã€‚\").rstrip(\".\").strip()\n\
          \            heading_in_content = compare_heading and content_first_line.startswith(compare_heading)\n\
          \n            if heading and not heading_in_content:\n                lines.append(heading)\n\
          \            if content:\n                lines.append(content)\n      \
          \      lines.append(\"\")  # é¡¹ä¹‹é—´ç©ºè¡Œ\n\n        lines.append(\"\")  # ä¸€çº§ä¹‹é—´ç©ºè¡Œ\n\
          \n    final_markdown = \"\\n\".join(lines).rstrip()  # å»æ‰æœ«å°¾å¤šä½™æ¢è¡Œ\n    return\
          \ {\"merged_markdown\": final_markdown}"
        code_language: python3
        desc: ''
        outputs:
          merged_markdown:
            children: null
            type: string
        selected: true
        title: æ‹¼æ¥å®¡è®¡é‡ç‚¹
        type: code
        variables:
        - value_selector:
          - '1763979170122'
          - output
          value_type: array[string]
          variable: arg1
      height: 53
      id: '1763979605691'
      position:
        x: 2054
        y: 282
      positionAbsolute:
        x: 2054
        y: 282
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        answer: '{{#1763979605691.merged_markdown#}}'
        desc: ''
        selected: false
        title: ç›´æ¥å›å¤
        type: answer
        variables: []
      height: 104
      id: '1763979693740'
      position:
        x: 2358
        y: 282
      positionAbsolute:
        x: 2358
        y: 282
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 243
    - data:
        author: hahaha
        desc: ''
        height: 109
        selected: false
        showAuthor: true
        text: '{"root":{"children":[{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"å®¡è®¡é‡ç‚¹ï¼Œæ¥è‡ªå¾€å¹´å®¡è®¡æ„è§çš„é«˜é¢‘","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""},{"children":[{"detail":0,"format":0,"mode":"normal","style":"","text":"æ£€ç´¢è¿‘1-3å¹´å·¥ä½œæ–¹æ¡ˆï¼Œç›´æ¥æŠŠå®¡è®¡é‡ç‚¹è®©å¤§æ¨¡å‹æŠ½å‡ºæ¥ã€‚","type":"text","version":1}],"direction":"ltr","format":"","indent":0,"type":"paragraph","version":1,"textFormat":0,"textStyle":""}],"direction":"ltr","format":"","indent":0,"type":"root","version":1}}'
        theme: blue
        title: ''
        type: ''
        width: 240
      height: 109
      id: '1764074070599'
      position:
        x: 328.4859175382879
        y: 94.66458512009194
      positionAbsolute:
        x: 328.4859175382879
        y: 94.66458512009194
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom-note
      width: 240
    viewport:
      x: -982.0018647021641
      y: 85.08690372317733
      zoom: 0.7444946874631861
